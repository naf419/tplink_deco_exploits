### Goal
Bypass firmware signature check that prevents tplink deco devices from loading user-provided firmware (i.e. openwrt)
in a way that doesn't require soldering on a serial console

### Vulnerability
- In tplink deco firmware, a modification was made to uboot to add http upload functionality to support
firmware installation directly from the bootloader as a failsafe procedure
- This modification introduced an unconstrained sscanf reading the "fw-type" field
from the user-provided firmware file into a fixed 256-byte stack buffer

### Exploit
- Take control of PC by overflowing stack buffer enough to override return address
- Point new return address to location within user-submitted firmware file to run arbitrary shellcode
- Develop shellcode to call back into stock uboot functionality to perform a tftp firmware load

### Details
- [v1_static](v1_static): initial version with hardcoded symbol addresses
- [v2_dynamic](v2_dynamic): second version which dynamically searches RAM for required functions, in order to remove
the necessity to initially attach a serial console to analyze the device-specific uboot partition to hardcode symbol addresses

### Possible Applicable Devices
[According to tplink](https://community.tp-link.com/us/home/kb/detail/490), uboot http recovery is present on the following devices:
- Deco E4
- Deco M4
- Deco P9
- Deco M9 Plus
- Deco X20/X60 V1 (firmware 1.2.5 or later version)
- Deco X20 V1.2 and later version
- Deco X60 V2 and later
- Deco S4

but these devices come in different "versions" which may have completely different hardware and uboot

### Device-specific static versions exist for:
- Deco S4 v2
- Deco M4R v1
- Deco M4R v2

### Device-independent dynamic version confirmed working for:
- Deco S4 v2
- Deco M4R v1
- Expecting others should work also, feedback appreciated
